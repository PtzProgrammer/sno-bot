# ๐ ะกะธััะตะผะฐ ะปะพะณะธัะพะฒะฐะฝะธั VK ะฑะพัะฐ ั ะธะฝัะตะณัะฐัะธะตะน ะฒ Cursor

## ๐ ะะฑะทะพั

ะกะธััะตะผะฐ ะปะพะณะธัะพะฒะฐะฝะธั ะฟัะตะดะพััะฐะฒะปัะตั ะฟะพะปะฝัะน ะผะพะฝะธัะพัะธะฝะณ ัะฐะฑะพัั VK ะฑะพัะฐ ั ัะดะพะฑะฝัะผ ะฟัะพัะผะพััะพะผ ะปะพะณะพะฒ ะฟััะผะพ ะฒ Cursor IDE.

## โจ ะะพะทะผะพะถะฝะพััะธ

- ๐ **ะกัััะบัััะธัะพะฒะฐะฝะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต** - JSON ัะพัะผะฐั ั ะผะตัะฐะดะฐะฝะฝัะผะธ
- ๐จ **ะฆะฒะตัะฝะพะน ะฒัะฒะพะด** ะฒ ะบะพะฝัะพะปั
- ๐ **ะะฒัะพะผะฐัะธัะตัะบะฐั ัะพัะฐัะธั** ะปะพะณ ัะฐะนะปะพะฒ
- ๐ **ะะธะฒะพะต ะพะฑะฝะพะฒะปะตะฝะธะต** ะฒ Cursor
- ๐ **ะกัะฐัะธััะธะบะฐ** ะธ ะผะตััะธะบะธ
- ๐ **REST API** ะดะปั ะฟัะพัะผะพััะฐ ะปะพะณะพะฒ
- ๐ค **ะญะบัะฟะพัั** ะฒ JSON/CSV ัะพัะผะฐัะฐั

## ๐๏ธ ะฃััะฐะฝะพะฒะบะฐ ะธ ะฝะฐัััะพะนะบะฐ

### 1. ะะฐะฒะธัะธะผะพััะธ
ะกะธััะตะผะฐ ะธัะฟะพะปัะทัะตั ัะพะปัะบะพ ะฒัััะพะตะฝะฝัะต ะผะพะดัะปะธ Node.js:
- `fs` - ัะฐะฑะพัะฐ ั ัะฐะนะปะฐะผะธ
- `path` - ัะฐะฑะพัะฐ ั ะฟัััะผะธ
- `console` - ะฒัะฒะพะด ะฒ ะบะพะฝัะพะปั

### 2. ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั
```bash
# ะฃัะพะฒะตะฝั ะปะพะณะธัะพะฒะฐะฝะธั (error, warn, info, debug, trace)
LOG_LEVEL=info

# ะะบะปััะธัั/ะฒัะบะปััะธัั ะทะฐะฟะธัั ะฒ ัะฐะนะป
LOG_TO_FILE=true

# ะะบะปััะธัั/ะฒัะบะปััะธัั ะฒัะฒะพะด ะฒ ะบะพะฝัะพะปั
LOG_TO_CONSOLE=true

# ะะบะปััะธัั/ะฒัะบะปััะธัั ะธะฝัะตะณัะฐัะธั ั Cursor
LOG_TO_CURSOR=true
```

## ๐ ะกัััะบัััะฐ ัะฐะนะปะพะฒ

```
vk-bot-simplified/
โโโ src/
โ   โโโ utils/
โ   โ   โโโ logger.js              # ะัะฝะพะฒะฝะพะน ะผะพะดัะปั ะปะพะณะธัะพะฒะฐะฝะธั
โ   โ   โโโ cursorIntegration.js   # ะะฝัะตะณัะฐัะธั ั Cursor
โ   โโโ routes/
โ       โโโ logRoutes.js           # API ะผะฐัััััั ะดะปั ะปะพะณะพะฒ
โโโ logs/                          # ะะพะณ ัะฐะนะปั (ัะพะทะดะฐะตััั ะฐะฒัะพะผะฐัะธัะตัะบะธ)
โ   โโโ bot.log                    # ะัะฝะพะฒะฝะพะน ะปะพะณ ัะฐะนะป
โ   โโโ bot.log.1                  # ะะพัะธัะพะฒะฐะฝะฝัะต ัะฐะนะปั
โ   โโโ cursor-logs.jsonl          # ะะพะณะธ ะดะปั Cursor
โโโ cursor-logs/                   # ะคะฐะนะปั ะดะปั Cursor (ัะพะทะดะฐะตััั ะฐะฒัะพะผะฐัะธัะตัะบะธ)
โ   โโโ README.md                  # ะะพะบัะผะตะฝัะฐัะธั
โ   โโโ live-logs.md               # ะะธะฒัะต ะปะพะณะธ
โ   โโโ bot-stats.json             # ะกัะฐัะธััะธะบะฐ
โ   โโโ recent-errors.md           # ะัะธะฑะบะธ
โ   โโโ performance.md             # ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั
โโโ test-logging.js                # ะขะตััะพะฒัะน ัะฐะนะป
```

## ๐ฏ ะัะฟะพะปัะทะพะฒะฐะฝะธะต

### ะะฐะทะพะฒะพะต ะปะพะณะธัะพะฒะฐะฝะธะต
```javascript
const logger = require('./src/utils/logger');

// ะะฐะทะฝัะต ััะพะฒะฝะธ ะปะพะณะธัะพะฒะฐะฝะธั
logger.error('ะัะธัะธัะตัะบะฐั ะพัะธะฑะบะฐ', { userId: 12345 });
logger.warn('ะัะตะดัะฟัะตะถะดะตะฝะธะต', { operation: 'sendMessage' });
logger.info('ะะฝัะพัะผะฐัะธะพะฝะฝะพะต ัะพะพะฑัะตะฝะธะต', { status: 'success' });
logger.debug('ะัะปะฐะดะพัะฝะฐั ะธะฝัะพัะผะฐัะธั', { data: {...} });
logger.trace('ะะตัะฐะปัะฝะฐั ััะฐััะธัะพะฒะบะฐ', { step: 'validation' });
```

### VK ัะฟะตัะธัะธัะฝัะต ะผะตัะพะดั
```javascript
// ะะพะณะธัะพะฒะฐะฝะธะต VK ัะพะพะฑัะตะฝะธะน
logger.vkMessage(userId, message, 'received');
logger.vkMessage(userId, response, 'sent');

// ะะพะณะธัะพะฒะฐะฝะธะต VK ะพัะธะฑะพะบ
logger.vkError(error, { userId, operation: 'sendMessage' });

// ะะพะณะธัะพะฒะฐะฝะธะต AI ะทะฐะฟัะพัะพะฒ
logger.aiRequest(userId, request, response);

// ะะพะณะธัะพะฒะฐะฝะธะต ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ
logger.performance('Operation Name', duration, { userId });
```

### ะะพะปััะตะฝะธะต ััะฐัะธััะธะบะธ
```javascript
const stats = logger.getStats();
console.log('ะัะตะณะพ ะปะพะณะพะฒ:', stats.total);
console.log('ะัะธะฑะบะธ:', stats.byLevel.error);
console.log('ะัะตะผั ัะฐะฑะพัั:', stats.uptime);
```

## ๐ API ัะฝะดะฟะพะธะฝัั

### GET /logs
ะัะพัะผะพัั ะปะพะณะพะฒ ั ัะธะปัััะฐัะธะตะน
```bash
# ะะฐะทะพะฒัะน ะทะฐะฟัะพั
GET /logs

# ะก ะฟะฐัะฐะผะตััะฐะผะธ
GET /logs?level=error&limit=50&since=2024-01-01T00:00:00Z
```

**ะะฐัะฐะผะตััั:**
- `level` - ััะพะฒะตะฝั ะปะพะณะธัะพะฒะฐะฝะธั (error, warn, info, debug, trace)
- `limit` - ะบะพะปะธัะตััะฒะพ ะปะพะณะพะฒ (ะฟะพ ัะผะพะปัะฐะฝะธั 100)
- `since` - ัะธะปััั ะฟะพ ะฒัะตะผะตะฝะธ (ISO ัะพัะผะฐั)
- `includeMeta` - ะฒะบะปััะฐัั ะผะตัะฐะดะฐะฝะฝัะต (true/false)

### GET /logs/stats
ะกัะฐัะธััะธะบะฐ ัะฐะฑะพัั ะฑะพัะฐ
```bash
GET /logs/stats
```

### GET /logs/export
ะญะบัะฟะพัั ะปะพะณะพะฒ
```bash
# JSON ัะพัะผะฐั
GET /logs/export?format=json&limit=1000

# CSV ัะพัะผะฐั
GET /logs/export?format=csv&level=error
```

### GET /logs/errors
ะะพัะปะตะดะฝะธะต ะพัะธะฑะบะธ
```bash
GET /logs/errors?limit=20
```

### GET /logs/performance
ะะตััะธะบะธ ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ
```bash
GET /logs/performance
```

### POST /logs/cleanup
ะัะธััะบะฐ ััะฐััั ะปะพะณะพะฒ
```bash
POST /logs/cleanup?days=7
```

## ๐ ะะฝัะตะณัะฐัะธั ั Cursor

### ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฑะฝะพะฒะปะตะฝะธะต
ะคะฐะนะปั ะฒ ะฟะฐะฟะบะต `cursor-logs/` ะพะฑะฝะพะฒะปััััั ะบะฐะถะดัะต 3 ัะตะบัะฝะดั:

- **live-logs.md** - ะถะธะฒัะต ะปะพะณะธ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ
- **bot-stats.json** - ััะฐัะธััะธะบะฐ ะฒ JSON ัะพัะผะฐัะต
- **recent-errors.md** - ะฟะพัะปะตะดะฝะธะต ะพัะธะฑะบะธ
- **performance.md** - ะผะตััะธะบะธ ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ

### ะัะพัะผะพัั ะฒ Cursor
1. ะัะบัะพะนัะต ะฟะฐะฟะบั `cursor-logs/` ะฒ Cursor
2. ะคะฐะนะปั ะฑัะดัั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะพะฑะฝะพะฒะปััััั
3. ะัะฟะพะปัะทัะนัะต `Ctrl+Shift+P` โ "Developer: Reload Window" ะดะปั ะพะฑะฝะพะฒะปะตะฝะธั

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

ะะฐะฟัััะธัะต ัะตััะพะฒัะน ัะฐะนะป:
```bash
node test-logging.js
```

ะขะตัั ะฟัะพะฒะตัะธั:
- โ ะะฐะทะพะฒะพะต ะปะพะณะธัะพะฒะฐะฝะธะต
- โ VK ัะฟะตัะธัะธัะฝัะต ะปะพะณะธ
- โ AI ะทะฐะฟัะพัั
- โ ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั
- โ ะะฐััะพะฒะพะต ะปะพะณะธัะพะฒะฐะฝะธะต
- โ ะะฑัะฐะฑะพัะบั ะพัะธะฑะพะบ
- โ ะกัะฐัะธััะธะบั
- โ ะญะบัะฟะพัั ะดะปั Cursor
- โ ะัะธััะบั ะปะพะณะพะฒ
- โ ะกะพะทะดะฐะฝะธะต ะดะฐะผะฟะพะฒ

## ๐ ะะพะฝะธัะพัะธะฝะณ

### ะ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ
- ะัะบัะพะนัะต `cursor-logs/live-logs.md` ะฒ Cursor
- ะคะฐะนะป ะพะฑะฝะพะฒะปัะตััั ะบะฐะถะดัะต 3 ัะตะบัะฝะดั
- ะะธะดะธัะต ะฒัะต ัะพะฑััะธั ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ

### ะกัะฐัะธััะธะบะฐ
- `cursor-logs/bot-stats.json` - JSON ััะฐัะธััะธะบะฐ
- `cursor-logs/performance.md` - ะผะตััะธะบะธ ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ
- `cursor-logs/recent-errors.md` - ะฟะพัะปะตะดะฝะธะต ะพัะธะฑะบะธ

### API ะผะพะฝะธัะพัะธะฝะณ
```bash
# ะัะพะฒะตัะบะฐ ะทะดะพัะพะฒัั
curl https://your-bot-url/health

# ะกัะฐัะธััะธะบะฐ
curl https://your-bot-url/logs/stats

# ะะพัะปะตะดะฝะธะต ะพัะธะฑะบะธ
curl https://your-bot-url/logs/errors
```

## โ๏ธ ะะฐัััะพะนะบะฐ

### ะฃัะพะฒะฝะธ ะปะพะณะธัะพะฒะฐะฝะธั
```javascript
// ะ ะบะพะดะต
logger.setLevel('debug');

// ะงะตัะตะท ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั
process.env.LOG_LEVEL = 'debug';
```

### ะะพัะฐัะธั ะปะพะณะพะฒ
```javascript
// ะะฐัััะพะนะบะฐ ะฒ logger.js
const logger = new Logger({
  maxFileSize: 10 * 1024 * 1024, // 10MB
  maxFiles: 5,                   // 5 ัะฐะนะปะพะฒ
  logDir: './custom-logs'        // ะะฐััะพะผะฝะฐั ะฟะฐะฟะบะฐ
});
```

### ะะฝัะตะณัะฐัะธั ั Cursor
```javascript
// ะะฐัััะพะนะบะฐ ะพะฑะฝะพะฒะปะตะฝะธั
const cursorIntegration = new CursorIntegration({
  updateInterval: 5000,    // 5 ัะตะบัะฝะด
  maxLogsInFile: 1000,     // 1000 ะปะพะณะพะฒ
  outputDir: './cursor'    // ะะฐััะพะผะฝะฐั ะฟะฐะฟะบะฐ
});
```

## ๐จ ะฃัััะฐะฝะตะฝะธะต ะฝะตะฟะพะปะฐะดะพะบ

### ะะพะณะธ ะฝะต ัะพะทะดะฐัััั
1. ะัะพะฒะตัััะต ะฟัะฐะฒะฐ ะฝะฐ ะทะฐะฟะธัั ะฒ ะฟะฐะฟะบั
2. ะฃะฑะตะดะธัะตัั, ััะพ `LOG_TO_FILE=true`
3. ะัะพะฒะตัััะต ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

### Cursor ะฝะต ะพะฑะฝะพะฒะปัะตััั
1. ะะตัะตะทะฐะณััะทะธัะต ะพะบะฝะพ: `Ctrl+Shift+P` โ "Developer: Reload Window"
2. ะัะพะฒะตัััะต, ััะพ ะธะฝัะตะณัะฐัะธั ะทะฐะฟััะตะฝะฐ
3. ะฃะฑะตะดะธัะตัั, ััะพ `LOG_TO_CURSOR=true`

### ะะพะปััะพะน ัะฐะทะผะตั ะปะพะณะพะฒ
1. ะะฐัััะพะนัะต ัะพัะฐัะธั ัะฐะนะปะพะฒ
2. ะัะฟะพะปัะทัะนัะต `logger.cleanup()` ะดะปั ะพัะธััะบะธ
3. ะฃะผะตะฝััะธัะต `maxLogsInFile`

### ะะตะดะปะตะฝะฝะฐั ัะฐะฑะพัะฐ
1. ะฃะฒะตะปะธัััะต `updateInterval`
2. ะฃะผะตะฝััะธัะต `maxLogsInFile`
3. ะัะบะปััะธัะต `LOG_TO_CURSOR` ะฒ ะฟัะพะดะฐะบัะตะฝะต

## ๐ ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั

### ะะตะบะพะผะตะฝะดะฐัะธะธ
- ะ ะฟัะพะดะฐะบัะตะฝะต ะธัะฟะพะปัะทัะนัะต `LOG_LEVEL=info` ะธะปะธ `warn`
- ะัะบะปััะธัะต `LOG_TO_CURSOR` ะฒ ะฟัะพะดะฐะบัะตะฝะต
- ะะฐัััะพะนัะต ะฐะฒัะพะผะฐัะธัะตัะบัั ะพัะธััะบั ะปะพะณะพะฒ
- ะะพะฝะธัะพัััะต ัะฐะทะผะตั ะปะพะณ ัะฐะนะปะพะฒ

### ะะตััะธะบะธ
- ะัะตะผั ะทะฐะฟะธัะธ ะปะพะณะฐ: ~1-2ms
- ะะฐะทะผะตั ะปะพะณะฐ: ~200-500 ะฑะฐะนั
- ะะฑะฝะพะฒะปะตะฝะธะต Cursor: ะบะฐะถะดัะต 3 ัะตะบัะฝะดั
- ะะพัะฐัะธั: ะฟัะธ ะดะพััะธะถะตะฝะธะธ 10MB

## ๐ ะะตะทะพะฟะฐัะฝะพััั

### ะะพะฝัะธะดะตะฝัะธะฐะปัะฝัะต ะดะฐะฝะฝัะต
```javascript
// ะะ ะปะพะณะธััะนัะต ะฟะฐัะพะปะธ ะธ ัะพะบะตะฝั
logger.info('User login', { 
  userId: 12345,
  // password: 'secret' // โ ะะ ะะะะะะขะ ะขะะ
});

// ะะพะณะธััะนัะต ัะพะปัะบะพ ะฑะตะทะพะฟะฐัะฝัะต ะดะฐะฝะฝัะต
logger.info('User login', { 
  userId: 12345,
  timestamp: new Date().toISOString() // โ ะะตะทะพะฟะฐัะฝะพ
});
```

### ะะฐัะบะธัะพะฒะฐะฝะธะต ะดะฐะฝะฝัั
```javascript
// ะะฒัะพะผะฐัะธัะตัะบะพะต ะผะฐัะบะธัะพะฒะฐะฝะธะต ะฒ logger.js
const sensitiveFields = ['password', 'token', 'secret', 'key'];
// ะญัะธ ะฟะพะปั ะฑัะดัั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะทะฐะผะฐัะบะธัะพะฒะฐะฝั
```

## ๐ ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### ะ VK ะฑะพัะต
```javascript
// ะะฑัะฐะฑะพัะบะฐ ัะพะพะฑัะตะฝะธั
async function processMessage(message) {
  const userId = message.from_id;
  const text = message.text;
  
  logger.vkMessage(userId, text, 'received');
  
  try {
    const response = await handleMessage(text);
    await sendMessage(userId, response);
    logger.vkMessage(userId, response, 'sent');
  } catch (error) {
    logger.vkError(error, { userId, text });
  }
}
```

### ะ AI ะฟะพะผะพัะฝะธะบะต
```javascript
async function handleAIRequest(userId, request) {
  const startTime = Date.now();
  
  logger.aiRequest(userId, request);
  
  try {
    const response = await getAIResponse(request);
    logger.aiRequest(userId, request, response);
    return response;
  } catch (error) {
    logger.error('AI request failed', { userId, request, error: error.message });
    throw error;
  } finally {
    const duration = Date.now() - startTime;
    logger.performance('AI Request', duration, { userId });
  }
}
```

---

## ๐ ะะพัะพะฒะพ!

ะขะตะฟะตัั ั ัะตะฑั ะตััั ะฟะพะปะฝะพัะตะฝะฝะฐั ัะธััะตะผะฐ ะปะพะณะธัะพะฒะฐะฝะธั ั ะธะฝัะตะณัะฐัะธะตะน ะฒ Cursor! 

**ะงัะพ ะดะฐะปััะต:**
1. ๐งช ะะฐะฟัััะธ `node test-logging.js` ะดะปั ัะตััะธัะพะฒะฐะฝะธั
2. ๐ ะัะบัะพะน ะฟะฐะฟะบั `cursor-logs/` ะฒ Cursor
3. ๐ ะัะฟะพะปัะทัะน API ัะฝะดะฟะพะธะฝัั ะดะปั ะผะพะฝะธัะพัะธะฝะณะฐ
4. ๐ ะะฐัััะพะน ะฐะฒัะพะผะฐัะธัะตัะบัั ะพัะธััะบั ะปะพะณะพะฒ

**ะะพะปะตะทะฝัะต ะบะพะผะฐะฝะดั:**
```bash
# ะขะตััะธัะพะฒะฐะฝะธะต
node test-logging.js

# ะัะพัะผะพัั ะปะพะณะพะฒ
tail -f logs/bot.log

# ะกัะฐัะธััะธะบะฐ
curl localhost:3000/logs/stats

# ะญะบัะฟะพัั
curl localhost:3000/logs/export?format=json > logs.json
```

ะฃะดะฐัะธ ั ะผะพะฝะธัะพัะธะฝะณะพะผ ัะฒะพะตะณะพ VK ะฑะพัะฐ! ๐
